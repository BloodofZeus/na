<!DOCTYPE html>
<html>
<head>
    <title>Test Order Confirmation</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Shawarma Boss POS - Order Confirmation Test</h1>
    
    <div id="test-results"></div>
    
    <button onclick="testLogin()">1. Test Login</button>
    <button onclick="testMenu()">2. Test Menu</button>
    <button onclick="testOrderCreation()">3. Test Order Creation</button>
    
    <script>
        const API_BASE = 'http://localhost:3001/api';
        let currentUser = null;
        
        function log(message) {
            document.getElementById('test-results').innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }
        
        async function testLogin() {
            try {
                const response = await fetch(API_BASE + '/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: 'admin', password: 'admin123' })
                });
                const result = await response.json();
                if (result.ok) {
                    currentUser = result;
                    log('✅ Login successful: ' + result.username + ' (' + result.role + ')');
                } else {
                    log('❌ Login failed: ' + result.error);
                }
            } catch (error) {
                log('❌ Login error: ' + error.message);
            }
        }
        
        async function testMenu() {
            try {
                const response = await fetch(API_BASE + '/menu');
                const menu = await response.json();
                log('✅ Menu loaded: ' + menu.length + ' items');
                menu.forEach(item => {
                    log('  - ' + item.name + ': GHS' + item.price + ' (Stock: ' + item.stock + ')');
                });
            } catch (error) {
                log('❌ Menu error: ' + error.message);
            }
        }
        
        async function testOrderCreation() {
            if (!currentUser) {
                log('❌ Please login first');
                return;
            }
            
            const testOrder = {
                id: 'test-order-' + Date.now(),
                user: currentUser.username,
                staff: currentUser.username,
                timestamp: new Date().toISOString(),
                items: [
                    { id: 'm-1', name: 'Shawarma Wrap', price: 20, quantity: 2 }
                ],
                total: 40,
                status: 'completed'
            };
            
            try {
                const response = await fetch(API_BASE + '/orders', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testOrder)
                });
                const result = await response.json();
                if (result.ok) {
                    log('✅ Order created successfully: ' + result.id);
                } else {
                    log('❌ Order creation failed: ' + result.error);
                }
            } catch (error) {
                log('❌ Order creation error: ' + error.message);
            }
        }
    </script>
</body>
</html>